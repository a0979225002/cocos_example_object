{"version":3,"sources":["assets\\Script\\EffectForShaderToy.js"],"names":["_default_vert","require","_default_vert_no_mvp","cc","Class","Component","properties","glassFactor","flagShader","frag_glsl","visible","onLoad","self","now","Date","parameters","startTime","time","mouse","x","y","z","w","resolution","date","getYear","getMonth","getDate","getTime","getMilliseconds","isMouseDown","node","on","Node","EventType","MOUSE_DOWN","event","MOUSE_UP","MOUSE_LEAVE","TOUCH_START","TOUCH_END","TOUCH_CANCEL","MOUSE_MOVE","getLocationX","getLocationY","TOUCH_MOVE","loader","loadRes","err","txt","log","_use","update","dt","_program","use","updateGLParameters","sys","isNative","glProgram_state","GLProgramState","getOrCreateWithGLProgram","setUniformVec3","setUniformFloat","setUniformVec4","setUniformLocationWith3f","_resolution","setUniformLocationWith1f","_time","setUniformLocationWith4f","_mouse","_date","getContentSize","width","height","GLProgram","initWithString","addAttribute","macro","ATTRIBUTE_NAME_POSITION","VERTEX_ATTRIB_POSITION","ATTRIBUTE_NAME_COLOR","VERTEX_ATTRIB_COLOR","ATTRIBUTE_NAME_TEX_COORD","VERTEX_ATTRIB_TEX_COORDS","link","updateUniforms","initWithVertexShaderByteArray","getUniformLocationForName","setProgram","_sgNode","program","setGLProgramState","setShaderProgram","children","i","length"],"mappings":";;;;;;AAAA,IAAIA,aAAa,GAAGC,OAAO,CAAC,qCAAD,CAA3B;;AACA,IAAIC,oBAAoB,GAAGD,OAAO,CAAC,2CAAD,CAAlC;AAIA;;;;;;;;;;;;;;;;;AAgBAE,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,WAAW,EAAC,GADJ;AAERC,IAAAA,UAAU,EAAC,EAFH;AAGRC,IAAAA,SAAS,EAAC;AACN,iBAAQ,kBADF;AAENC,MAAAA,OAAO,EAAC;AAFF;AAHF,GAHP;AAYLC,EAAAA,MAAM,EAAE,kBAAY;AAChB,QAAIC,IAAI,GAAG,IAAX;AACA,QAAIC,GAAG,GAAG,IAAIC,IAAJ,EAAV;AACA,SAAKC,UAAL,GAAgB;AACZC,MAAAA,SAAS,EAACF,IAAI,CAACD,GAAL,EADE;AAEZI,MAAAA,IAAI,EAAC,GAFO;AAGZC,MAAAA,KAAK,EAAC;AACFC,QAAAA,CAAC,EAAC,GADA;AAEFC,QAAAA,CAAC,EAAC,GAFA;AAGFC,QAAAA,CAAC,EAAC,GAHA;AAIFC,QAAAA,CAAC,EAAC;AAJA,OAHM;AASZC,MAAAA,UAAU,EAAC;AACPJ,QAAAA,CAAC,EAAC,GADK;AAEPC,QAAAA,CAAC,EAAC,GAFK;AAGPC,QAAAA,CAAC,EAAC;AAHK,OATC;AAcZG,MAAAA,IAAI,EAAC;AACDL,QAAAA,CAAC,EAACN,GAAG,CAACY,OAAJ,EADD;AACe;AAChBL,QAAAA,CAAC,EAACP,GAAG,CAACa,QAAJ,EAFD;AAEgB;AACjBL,QAAAA,CAAC,EAACR,GAAG,CAACc,OAAJ,EAHD;AAGe;AAChBL,QAAAA,CAAC,EAACT,GAAG,CAACe,OAAJ,KAAcf,GAAG,CAACgB,eAAJ,KAAsB,IAJrC,CAI0C;;AAJ1C,OAdO;AAoBZC,MAAAA,WAAW,EAAC;AApBA,KAAhB;AAuBA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBC,UAA/B,EAA2C,UAAUC,KAAV,EAAiB;AACxD,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,IAA5B;AACH,KAFD,EAEG,IAFH;AAKA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBG,QAA/B,EAAyC,UAAUD,KAAV,EAAiB;AACtD,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,KAA5B;AACH,KAFD,EAEG,IAFH;AAIA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBI,WAA/B,EAA4C,UAAUF,KAAV,EAAiB;AACzD,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,KAA5B;AACH,KAFD,EAEG,IAFH;AAKA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBK,WAA/B,EAA4C,UAAUH,KAAV,EAAiB;AACzD,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,IAA5B;AACH,KAFD,EAEG,IAFH;AAKA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBM,SAA/B,EAA0C,UAAUJ,KAAV,EAAiB;AACvD,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,KAA5B;AACH,KAFD,EAEG,IAFH;AAIA,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBO,YAA/B,EAA6C,UAAUL,KAAV,EAAiB;AAC1D,WAAKrB,UAAL,CAAgBe,WAAhB,GAA4B,KAA5B;AACH,KAFD,EAEG,IAFH;AAMC,SAAKC,IAAL,CAAUC,EAAV,CAAa7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBQ,UAA/B,EAA2C,UAAUN,KAAV,EAAiB;AACzD,UAAG,KAAKrB,UAAL,CAAgBe,WAAnB,EAA+B;AAC3B,aAAKf,UAAL,CAAgBG,KAAhB,CAAsBC,CAAtB,GAA0BiB,KAAK,CAACO,YAAN,EAA1B;AACA,aAAK5B,UAAL,CAAgBG,KAAhB,CAAsBE,CAAtB,GAA0BgB,KAAK,CAACQ,YAAN,EAA1B;AACH;AACJ,KALA,EAKE,IALF;AAQD,SAAKb,IAAL,CAAUC,EAAV,CAAc7B,EAAE,CAAC8B,IAAH,CAAQC,SAAR,CAAkBW,UAAhC,EAA4C,UAAUT,KAAV,EAAiB;AACzD,UAAG,KAAKrB,UAAL,CAAgBe,WAAnB,EAA+B;AAC3B,aAAKf,UAAL,CAAgBG,KAAhB,CAAsBC,CAAtB,GAA0BiB,KAAK,CAACO,YAAN,EAA1B;AACA,aAAK5B,UAAL,CAAgBG,KAAhB,CAAsBE,CAAtB,GAA0BgB,KAAK,CAACQ,YAAN,EAA1B;AACH;AACJ,KALD,EAKG,IALH;AAOAzC,IAAAA,EAAE,CAAC2C,MAAH,CAAUC,OAAV,CAAkBnC,IAAI,CAACJ,UAAvB,EAAkC,UAASwC,GAAT,EAAaC,GAAb,EAAiB;AAC/C,UAAGD,GAAH,EAAO;AACH7C,QAAAA,EAAE,CAAC+C,GAAH,CAAOF,GAAP;AACH,OAFD,MAEK;AACDpC,QAAAA,IAAI,CAACH,SAAL,GAAiBwC,GAAjB;;AACArC,QAAAA,IAAI,CAACuC,IAAL;AACH;AACJ,KAPD;AASH,GA3FI;AA4FLC,EAAAA,MAAM,EAAC,gBAASC,EAAT,EAAY;AACf,QAAG,KAAK9C,WAAL,IAAkB,EAArB,EAAwB;AACpB,WAAKA,WAAL,GAAiB,CAAjB;AACH;;AACD,SAAKA,WAAL,IAAkB8C,EAAE,GAAC,CAArB;;AAEA,QAAG,KAAKC,QAAR,EAAiB;AAEb,WAAKA,QAAL,CAAcC,GAAd;;AACA,WAAKC,kBAAL;;AACA,UAAGrD,EAAE,CAACsD,GAAH,CAAOC,QAAV,EAAmB;AACf,YAAIC,eAAe,GAAGxD,EAAE,CAACyD,cAAH,CAAkBC,wBAAlB,CAA2C,KAAKP,QAAhD,CAAtB;AACAK,QAAAA,eAAe,CAACG,cAAhB,CAAgC,aAAhC,EAA+C,KAAK/C,UAAL,CAAgBQ,UAA/D;AACAoC,QAAAA,eAAe,CAACI,eAAhB,CAAiC,aAAjC,EAAgD,KAAKhD,UAAL,CAAgBE,IAAhE;AACA0C,QAAAA,eAAe,CAACK,cAAhB,CAAgC,QAAhC,EAA2C,KAAKjD,UAAL,CAAgBG,KAA3D;AACAyC,QAAAA,eAAe,CAACK,cAAhB,CAAgC,OAAhC,EAA0C,KAAKjD,UAAL,CAAgBS,IAA1D;AACH,OAND,MAMK;AACD,aAAK8B,QAAL,CAAcW,wBAAd,CAAwC,KAAKC,WAA7C,EAA0D,KAAKnD,UAAL,CAAgBQ,UAAhB,CAA2BJ,CAArF,EAAuF,KAAKJ,UAAL,CAAgBQ,UAAhB,CAA2BH,CAAlH,EAAoH,KAAKL,UAAL,CAAgBQ,UAAhB,CAA2BF,CAA/I;;AACA,aAAKiC,QAAL,CAAca,wBAAd,CAAwC,KAAKC,KAA7C,EAAoD,KAAKrD,UAAL,CAAgBE,IAApE;;AACA,aAAKqC,QAAL,CAAce,wBAAd,CAAwC,KAAKC,MAA7C,EAAqD,KAAKvD,UAAL,CAAgBG,KAAhB,CAAsBC,CAA3E,EAA6E,KAAKJ,UAAL,CAAgBG,KAAhB,CAAsBE,CAAnG,EAAqG,KAAKL,UAAL,CAAgBG,KAAhB,CAAsBG,CAA3H,EAA6H,KAAKN,UAAL,CAAgBG,KAAhB,CAAsBI,CAAnJ;;AACA,aAAKgC,QAAL,CAAce,wBAAd,CAAwC,KAAKE,KAA7C,EAAoD,KAAKxD,UAAL,CAAgBS,IAAhB,CAAqBL,CAAzE,EAA2E,KAAKJ,UAAL,CAAgBS,IAAhB,CAAqBJ,CAAhG,EAAkG,KAAKL,UAAL,CAAgBS,IAAhB,CAAqBH,CAAvH,EAAyH,KAAKN,UAAL,CAAgBS,IAAhB,CAAqBF,CAA9I;AACH;AACJ;AACJ,GAnHI;AAoHLkC,EAAAA,kBAAkB,EAAC,8BAAU;AACzB,SAAKzC,UAAL,CAAgBE,IAAhB,GAAuB,CAACH,IAAI,CAACD,GAAL,KAAa,KAAKE,UAAL,CAAgBC,SAA9B,IAAyC,IAAhE;AACA,SAAKD,UAAL,CAAgBQ,UAAhB,CAA2BJ,CAA3B,GAAiC,KAAKY,IAAL,CAAUyC,cAAV,GAA2BC,KAA5D;AACA,SAAK1D,UAAL,CAAgBQ,UAAhB,CAA2BH,CAA3B,GAAiC,KAAKW,IAAL,CAAUyC,cAAV,GAA2BE,MAA5D;AACA,QAAI7D,GAAG,GAAG,IAAIC,IAAJ,EAAV;AAEA,SAAKC,UAAL,CAAgBS,IAAhB,GAAqB;AACbL,MAAAA,CAAC,EAACN,GAAG,CAACY,OAAJ,EADW;AACG;AAChBL,MAAAA,CAAC,EAACP,GAAG,CAACa,QAAJ,EAFW;AAEI;AACjBL,MAAAA,CAAC,EAACR,GAAG,CAACc,OAAJ,EAHW;AAGG;AAChBL,MAAAA,CAAC,EAACT,GAAG,CAACe,OAAJ,KAAcf,GAAG,CAACgB,eAAJ,KAAsB,IAJzB,CAI8B;;AAJ9B,KAArB;AAMH,GAhII;AAkILsB,EAAAA,IAAI,EAAE,gBACN;AAEI,QAAIhD,EAAE,CAACsD,GAAH,CAAOC,QAAX,EAAqB;AACjBvD,MAAAA,EAAE,CAAC+C,GAAH,CAAO,sBAAP;AACA,WAAKI,QAAL,GAAgB,IAAInD,EAAE,CAACwE,SAAP,EAAhB;;AACA,WAAKrB,QAAL,CAAcsB,cAAd,CAA6B1E,oBAA7B,EAAmD,KAAKO,SAAxD;;AAGA,WAAK6C,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASC,uBAApC,EAA6D5E,EAAE,CAAC2E,KAAH,CAASE,sBAAtE;;AACA,WAAK1B,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASG,oBAApC,EAA0D9E,EAAE,CAAC2E,KAAH,CAASI,mBAAnE;;AACA,WAAK5B,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASK,wBAApC,EAA8DhF,EAAE,CAAC2E,KAAH,CAASM,wBAAvE;;AAEA,WAAK9B,QAAL,CAAc+B,IAAd;;AACA,WAAK/B,QAAL,CAAcgC,cAAd;;AACA,WAAK9B,kBAAL;AAIH,KAhBD,MAgBK;AACD,WAAKF,QAAL,GAAgB,IAAInD,EAAE,CAACwE,SAAP,EAAhB;;AACA,WAAKrB,QAAL,CAAciC,6BAAd,CAA4CvF,aAA5C,EAA2D,KAAKS,SAAhE;;AACA,WAAK6C,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASC,uBAApC,EAA6D5E,EAAE,CAAC2E,KAAH,CAASE,sBAAtE;;AACA,WAAK1B,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASG,oBAApC,EAA0D9E,EAAE,CAAC2E,KAAH,CAASI,mBAAnE;;AACA,WAAK5B,QAAL,CAAcuB,YAAd,CAA2B1E,EAAE,CAAC2E,KAAH,CAASK,wBAApC,EAA8DhF,EAAE,CAAC2E,KAAH,CAASM,wBAAvE;;AAEA,WAAK9B,QAAL,CAAc+B,IAAd;;AACA,WAAK/B,QAAL,CAAcgC,cAAd;;AACA,WAAKhC,QAAL,CAAcC,GAAd;;AAEA,WAAKC,kBAAL;;AAEA,WAAKF,QAAL,CAAcW,wBAAd,CAAuC,KAAKX,QAAL,CAAckC,yBAAd,CAAwC,aAAxC,CAAvC,EAA+F,KAAKzE,UAAL,CAAgBQ,UAAhB,CAA2BJ,CAA1H,EAA4H,KAAKJ,UAAL,CAAgBQ,UAAhB,CAA2BH,CAAvJ,EAAyJ,KAAKL,UAAL,CAAgBQ,UAAhB,CAA2BF,CAApL;;AACA,WAAKiC,QAAL,CAAca,wBAAd,CAAwC,KAAKb,QAAL,CAAckC,yBAAd,CAAwC,aAAxC,CAAxC,EAAgG,KAAKzE,UAAL,CAAgBE,IAAhH;;AACA,WAAKqC,QAAL,CAAce,wBAAd,CAAwC,KAAKf,QAAL,CAAckC,yBAAd,CAAwC,QAAxC,CAAxC,EAA2F,KAAKzE,UAAL,CAAgBG,KAAhB,CAAsBC,CAAjH,EAAmH,KAAKJ,UAAL,CAAgBG,KAAhB,CAAsBE,CAAzI,EAA6I,KAAKL,UAAL,CAAgBG,KAAhB,CAAsBG,CAAnK,EAAqK,KAAKN,UAAL,CAAgBG,KAAhB,CAAsBI,CAA3L;;AACA,WAAKgC,QAAL,CAAce,wBAAd,CAAwC,KAAKf,QAAL,CAAckC,yBAAd,CAAwC,OAAxC,CAAxC,EAA0F,KAAKzE,UAAL,CAAgBS,IAAhB,CAAqBL,CAA/G,EAAiH,KAAKJ,UAAL,CAAgBS,IAAhB,CAAqBJ,CAAtI,EAAwI,KAAKL,UAAL,CAAgBS,IAAhB,CAAqBH,CAA7J,EAA+J,KAAKN,UAAL,CAAgBS,IAAhB,CAAqBF,CAApL;AAEH;;AAKD,QAAInB,EAAE,CAACsD,GAAH,CAAOC,QAAX,EAAqB;AACjB,UAAIC,eAAe,GAAGxD,EAAE,CAACyD,cAAH,CAAkBC,wBAAlB,CAA2C,KAAKP,QAAhD,CAAtB;AACAK,MAAAA,eAAe,CAACG,cAAhB,CAAgC,aAAhC,EAA+C,KAAK/C,UAAL,CAAgBQ,UAA/D;AACAoC,MAAAA,eAAe,CAACI,eAAhB,CAAiC,aAAjC,EAAiD,KAAKhD,UAAL,CAAgBE,IAAjE;AACA0C,MAAAA,eAAe,CAACK,cAAhB,CAAgC,QAAhC,EAA2C,KAAKjD,UAAL,CAAgBG,KAA3D;AACH,KALD,MAKK;AAGD,WAAKgD,WAAL,GAAmB,KAAKZ,QAAL,CAAckC,yBAAd,CAAyC,aAAzC,CAAnB;AACA,WAAKpB,KAAL,GAAa,KAAKd,QAAL,CAAckC,yBAAd,CAAyC,aAAzC,CAAb;AACA,WAAKlB,MAAL,GAAc,KAAKhB,QAAL,CAAckC,yBAAd,CAAyC,QAAzC,CAAd;;AAEA,WAAKlC,QAAL,CAAcW,wBAAd,CAAwC,KAAKC,WAA7C,EAA0D,KAAKnD,UAAL,CAAgBQ,UAAhB,CAA2BJ,CAArF,EAAuF,KAAKJ,UAAL,CAAgBQ,UAAhB,CAA2BH,CAAlH,EAAoH,KAAKL,UAAL,CAAgBQ,UAAhB,CAA2BF,CAA/I;;AACA,WAAKiC,QAAL,CAAca,wBAAd,CAAwC,KAAKC,KAA7C,EAAoD,KAAKrD,UAAL,CAAgBE,IAApE;;AACA,WAAKqC,QAAL,CAAce,wBAAd,CAAwC,KAAKC,MAA7C,EAAqD,KAAKvD,UAAL,CAAgBG,KAAhB,CAAsBC,CAA3E,EAA6E,KAAKJ,UAAL,CAAgBG,KAAhB,CAAsBE,CAAnG,EAAsG,KAAKL,UAAL,CAAgBG,KAAhB,CAAsBG,CAA5H,EAA8H,KAAKN,UAAL,CAAgBG,KAAhB,CAAsBI,CAApJ;;AACA,WAAKgC,QAAL,CAAce,wBAAd,CAAwC,KAAKE,KAA7C,EAAoD,KAAKxD,UAAL,CAAgBS,IAAhB,CAAqBL,CAAzE,EAA2E,KAAKJ,UAAL,CAAgBS,IAAhB,CAAqBJ,CAAhG,EAAkG,KAAKL,UAAL,CAAgBS,IAAhB,CAAqBH,CAAvH,EAAyH,KAAKN,UAAL,CAAgBS,IAAhB,CAAqBF,CAA9I;AACH;;AAED,SAAKmE,UAAL,CAAiB,KAAK1D,IAAL,CAAU2D,OAA3B,EAAoC,KAAKpC,QAAzC;AACH,GA/LI;AAiMLmC,EAAAA,UAAU,EAAC,oBAAU1D,IAAV,EAAgB4D,OAAhB,EAAyB;AAChC,QAAIxF,EAAE,CAACsD,GAAH,CAAOC,QAAX,EAAqB;AACjB,UAAIC,eAAe,GAAGxD,EAAE,CAACyD,cAAH,CAAkBC,wBAAlB,CAA2C8B,OAA3C,CAAtB;AACA5D,MAAAA,IAAI,CAAC6D,iBAAL,CAAuBjC,eAAvB;AACH,KAHD,MAGK;AACD5B,MAAAA,IAAI,CAAC8D,gBAAL,CAAsBF,OAAtB;AACH;;AAGD,QAAIG,QAAQ,GAAG/D,IAAI,CAAC+D,QAApB;AACA,QAAI,CAACA,QAAL,EACI;;AAEJ,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,QAAQ,CAACE,MAA7B,EAAqCD,CAAC,EAAtC;AACI,WAAKN,UAAL,CAAgBK,QAAQ,CAACC,CAAD,CAAxB,EAA6BJ,OAA7B;AADJ;AAEH;AAhNI,CAAT","sourceRoot":"/","sourcesContent":["var _default_vert = require(\"../Shaders/ccShader_Default_Vert.js\");\r\nvar _default_vert_no_mvp = require(\"../Shaders/ccShader_Default_Vert_noMVP.js\");\r\n\r\n\r\n\r\n/*\r\n\r\nShader Inputs\r\nuniform vec3      iResolution;           // viewport resolution (in pixels)\r\nuniform float     iGlobalTime;           // shader playback time (in seconds)\r\nuniform float     iTimeDelta;            // render time (in seconds)\r\nuniform int       iFrame;                // shader playback frame\r\nuniform float     iChannelTime[4];       // channel playback time (in seconds)\r\nuniform vec3      iChannelResolution[4]; // channel resolution (in pixels)\r\nuniform vec4      iMouse;                // mouse pixel coords. xy: current (if MLB down), zw: click\r\nuniform samplerXX iChannel0..3;          // input channel. XX = 2D/Cube\r\nuniform vec4      iDate;                 // (year, month, day, time in seconds)\r\nuniform float     iSampleRate;           // sound sample rate (i.e., 44100)\r\n\r\n*/\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        glassFactor:1.0,\r\n        flagShader:\"\",\r\n        frag_glsl:{\r\n            default:\"Effect10.fs.glsl\",\r\n            visible:false,\r\n        }\r\n    }, \r\n\r\n    onLoad: function () {\r\n        var self = this;\r\n        var now = new Date();\r\n        this.parameters={\r\n            startTime:Date.now(),\r\n            time:0.0,\r\n            mouse:{\r\n                x:0.0,\r\n                y:0.0,\r\n                z:0.0,\r\n                w:0.0,\r\n            },\r\n            resolution:{\r\n                x:0.0,\r\n                y:0.0,\r\n                z:1.0,\r\n            },\r\n            date:{\r\n                x:now.getYear(),//year\r\n                y:now.getMonth(),//month\r\n                z:now.getDate(),//day\r\n                w:now.getTime()+now.getMilliseconds()/1000,//time seconds\r\n            },\r\n            isMouseDown:false,\r\n\r\n        };\r\n        this.node.on(cc.Node.EventType.MOUSE_DOWN, function (event) {\r\n            this.parameters.isMouseDown=true;\r\n        }, this);\r\n\r\n\r\n        this.node.on(cc.Node.EventType.MOUSE_UP, function (event) {\r\n            this.parameters.isMouseDown=false;\r\n        }, this);\r\n\r\n        this.node.on(cc.Node.EventType.MOUSE_LEAVE, function (event) {\r\n            this.parameters.isMouseDown=false;\r\n        }, this);\r\n\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n            this.parameters.isMouseDown=true;\r\n        }, this);\r\n\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            this.parameters.isMouseDown=false;\r\n        }, this);\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {\r\n            this.parameters.isMouseDown=false;\r\n        }, this);\r\n\r\n\r\n\r\n         this.node.on(cc.Node.EventType.MOUSE_MOVE, function (event) {\r\n            if(this.parameters.isMouseDown){\r\n                this.parameters.mouse.x = event.getLocationX();\r\n                this.parameters.mouse.y = event.getLocationY(); \r\n            }\r\n        }, this);\r\n\r\n\r\n        this.node.on( cc.Node.EventType.TOUCH_MOVE, function (event) {\r\n            if(this.parameters.isMouseDown){\r\n                this.parameters.mouse.x = event.getLocationX();\r\n                this.parameters.mouse.y = event.getLocationY(); \r\n            }\r\n        }, this);\r\n\r\n        cc.loader.loadRes(self.flagShader,function(err,txt){\r\n            if(err){\r\n                cc.log(err)\r\n            }else{\r\n                self.frag_glsl = txt;\r\n                self._use();\r\n            }\r\n        });\r\n\r\n    },\r\n    update:function(dt){\r\n        if(this.glassFactor>=40){\r\n            this.glassFactor=0;\r\n        }\r\n        this.glassFactor+=dt*3;\r\n\r\n        if(this._program){\r\n\r\n            this._program.use();\r\n            this.updateGLParameters();\r\n            if(cc.sys.isNative){\r\n                var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);\r\n                glProgram_state.setUniformVec3( \"iResolution\", this.parameters.resolution );\r\n                glProgram_state.setUniformFloat( \"iGlobalTime\", this.parameters.time );    \r\n                glProgram_state.setUniformVec4( \"iMouse\" , this.parameters.mouse );\r\n                glProgram_state.setUniformVec4( \"iDate\" , this.parameters.date );\r\n            }else{\r\n                this._program.setUniformLocationWith3f( this._resolution, this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n                this._program.setUniformLocationWith1f( this._time, this.parameters.time );\r\n                this._program.setUniformLocationWith4f( this._mouse, this.parameters.mouse.x,this.parameters.mouse.y,this.parameters.mouse.z,this.parameters.mouse.w );\r\n                this._program.setUniformLocationWith4f( this._date, this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n            }\r\n        }\r\n    },\r\n    updateGLParameters:function(){\r\n        this.parameters.time = (Date.now() - this.parameters.startTime)/1000;\r\n        this.parameters.resolution.x = ( this.node.getContentSize().width );\r\n        this.parameters.resolution.y = ( this.node.getContentSize().height );\r\n        var now = new Date();\r\n\r\n        this.parameters.date={\r\n                x:now.getYear(),//year\r\n                y:now.getMonth(),//month\r\n                z:now.getDate(),//day\r\n                w:now.getTime()+now.getMilliseconds()/1000,//time seconds\r\n            };\r\n    },\r\n\r\n    _use: function()\r\n    {\r\n        \r\n        if (cc.sys.isNative) {\r\n            cc.log(\"use native GLProgram\");\r\n            this._program = new cc.GLProgram();\r\n            this._program.initWithString(_default_vert_no_mvp, this.frag_glsl );\r\n\r\n\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);\r\n\r\n            this._program.link();\r\n            this._program.updateUniforms();\r\n            this.updateGLParameters();\r\n\r\n\r\n           \r\n        }else{\r\n            this._program = new cc.GLProgram();\r\n            this._program.initWithVertexShaderByteArray(_default_vert, this.frag_glsl );\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);\r\n\r\n            this._program.link();\r\n            this._program.updateUniforms();\r\n            this._program.use();\r\n\r\n            this.updateGLParameters();\r\n\r\n            this._program.setUniformLocationWith3f(this._program.getUniformLocationForName('iResolution'), this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n            this._program.setUniformLocationWith1f( this._program.getUniformLocationForName('iGlobalTime'), this.parameters.time );\r\n            this._program.setUniformLocationWith4f( this._program.getUniformLocationForName('iMouse'), this.parameters.mouse.x,this.parameters.mouse.y , this.parameters.mouse.z,this.parameters.mouse.w);\r\n            this._program.setUniformLocationWith4f( this._program.getUniformLocationForName('iDate'), this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n\r\n        }\r\n\r\n        \r\n\r\n        \r\n        if (cc.sys.isNative) {\r\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);\r\n            glProgram_state.setUniformVec3( \"iResolution\", this.parameters.resolution );\r\n            glProgram_state.setUniformFloat( \"iGlobalTime\" , this.parameters.time );\r\n            glProgram_state.setUniformVec4( \"iMouse\" , this.parameters.mouse );\r\n        }else{\r\n\r\n\r\n            this._resolution = this._program.getUniformLocationForName( \"iResolution\" );\r\n            this._time = this._program.getUniformLocationForName( \"iGlobalTime\" );\r\n            this._mouse = this._program.getUniformLocationForName( \"iMouse\" );\r\n\r\n            this._program.setUniformLocationWith3f( this._resolution, this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n            this._program.setUniformLocationWith1f( this._time, this.parameters.time );\r\n            this._program.setUniformLocationWith4f( this._mouse, this.parameters.mouse.x,this.parameters.mouse.y ,this.parameters.mouse.z,this.parameters.mouse.w);\r\n            this._program.setUniformLocationWith4f( this._date, this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n        }\r\n\r\n        this.setProgram( this.node._sgNode ,this._program );\r\n    },\r\n    \r\n    setProgram:function (node, program) {\r\n        if (cc.sys.isNative) {\r\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(program);\r\n            node.setGLProgramState(glProgram_state);\r\n        }else{\r\n            node.setShaderProgram(program);    \r\n        }\r\n        \r\n    \r\n        var children = node.children;\r\n        if (!children)\r\n            return;\r\n    \r\n        for (var i = 0; i < children.length; i++)\r\n            this.setProgram(children[i], program);\r\n    }\r\n\r\n});\r\n"]}