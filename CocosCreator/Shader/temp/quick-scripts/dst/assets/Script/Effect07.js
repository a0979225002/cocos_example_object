
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Effect07.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '7be053+GGBArIrzaFkYCT1g', 'Effect07');
// Script/Effect07.js

"use strict";

var _default_vert = require("../Shaders/ccShader_Default_Vert.js");

var _default_vert_no_mvp = require("../Shaders/ccShader_Default_Vert_noMVP.js");

var _glass_frag = require("../Shaders/ccShader_Effect04_Frag.js");

cc.Class({
  "extends": cc.Component,
  properties: {
    glassFactor: 1.0,
    flagShader: {
      "default": '"precision mediump float; uniform float time; uniform vec2 mouse; uniform vec2 resolution; const int numBlobs = 128; void main( void ) {     vec2 p = (gl_FragCoord.xy / resolution.x) - vec2(0.5, 0.5 * (resolution.y / resolution.x));     vec3 c = vec3(0.0);     for (int i=0; i<numBlobs; i++)  {       float px = sin(float(i)*0.1 + 0.5) * 0.4;       float py = sin(float(i*i)*0.01 + 0.4*time) * 0.2;       float pz = sin(float(i*i*i)*0.001 + 0.3*time) * 0.3 + 0.4;      float radius = 0.005 / pz;      vec2 pos = p + vec2(px, py);        float z = radius - length(pos);         if (z < 0.0) z = 0.0;       float cc = z / radius;      c += vec3(cc * (sin(float(i*i*i)) * 0.5 + 0.5), cc * (sin(float(i*i*i*i*i)) * 0.5 + 0.5), cc * (sin(float(i*i*i*i)) * 0.5 + 0.5));  }   gl_FragColor = vec4(c.x+p.y, c.y+p.y, c.z+p.y, 1.0); }",',
      multiline: true,
      tooltip: 'FlagShader'
    }
  },
  onLoad: function onLoad() {
    this.parameters = {
      startTime: Date.now(),
      time: 0.0,
      mouse: {
        x: 0.0,
        y: 0.0
      },
      resolution: {
        x: 0.0,
        y: 0.0
      }
    };
    this.node.on(cc.Node.EventType.MOUSE_MOVE, function (event) {
      this.parameters.mouse.x = this.node.getContentSize().width / event.getLocationX();
      this.parameters.mouse.y = this.node.getContentSize().height / event.getLocationY();
    }, this);
    this.node.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
      this.parameters.mouse.x = this.node.getContentSize().width / event.getLocationX();
      this.parameters.mouse.y = this.node.getContentSize().height / event.getLocationY();
    }, this);

    this._use();
  },
  update: function update(dt) {
    if (this.glassFactor >= 40) {
      this.glassFactor = 0;
    }

    this.glassFactor += dt * 3;

    if (this._program) {
      this._program.use();

      this.updateGLParameters();

      if (cc.sys.isNative) {
        var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);
        glProgram_state.setUniformVec2("resolution", this.parameters.resolution);
        glProgram_state.setUniformFloat("time", this.parameters.time);
        glProgram_state.setUniformVec2("mouse_touch", this.parameters.mouse);
      } else {
        this._program.setUniformLocationWith2f(this._resolution, this.parameters.resolution.x, this.parameters.resolution.y);

        this._program.setUniformLocationWith1f(this._time, this.parameters.time);

        this._program.setUniformLocationWith2f(this._mouse, this.parameters.mouse.x, this.parameters.mouse.x);
      }
    }
  },
  updateGLParameters: function updateGLParameters() {
    this.parameters.time = (Date.now() - this.parameters.startTime) / 1000;
    this.parameters.resolution.x = this.node.getContentSize().width;
    this.parameters.resolution.y = this.node.getContentSize().height;
  },
  _use: function _use() {
    if (cc.sys.isNative) {
      cc.log("use native GLProgram");
      this._program = new cc.GLProgram();

      this._program.initWithString(_default_vert_no_mvp, this.flagShader);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);

      this._program.link();

      this._program.updateUniforms();

      this.updateGLParameters();
    } else {
      this._program = new cc.GLProgram();

      this._program.initWithVertexShaderByteArray(_default_vert, this.flagShader);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);

      this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);

      this._program.link();

      this._program.updateUniforms();

      this._program.use();

      this.updateGLParameters();

      this._program.setUniformLocationWith1f(this._program.getUniformLocationForName('time'), this.parameters.time);

      this._program.setUniformLocationWith2f(this._program.getUniformLocationForName('mouse_touch'), this.parameters.mouse.x, this.parameters.mouse.y);

      this._program.setUniformLocationWith2f(this._program.getUniformLocationForName('resolution'), this.parameters.resolution.x, this.parameters.resolution.y);
    }

    if (cc.sys.isNative) {
      var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);
      glProgram_state.setUniformVec2("resolution", this.parameters.resolution);
      glProgram_state.setUniformFloat("time", this.parameters.time);
      glProgram_state.setUniformVec2("mouse_touch", this.parameters.mouse);
    } else {
      this._resolution = this._program.getUniformLocationForName("resolution");
      this._time = this._program.getUniformLocationForName("time");
      this._mouse = this._program.getUniformLocationForName("mouse_touch");

      this._program.setUniformLocationWith2f(this._resolution, this.parameters.resolution.x, this.parameters.resolution.y);

      this._program.setUniformLocationWith1f(this._time, this.parameters.time);

      this._program.setUniformLocationWith2f(this._mouse, this.parameters.mouse.x, this.parameters.mouse.y);
    }

    this.setProgram(this.node._sgNode, this._program);
  },
  setProgram: function setProgram(node, program) {
    if (cc.sys.isNative) {
      var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(program);
      node.setGLProgramState(glProgram_state);
    } else {
      node.setShaderProgram(program);
    }

    var children = node.children;
    if (!children) return;

    for (var i = 0; i < children.length; i++) {
      this.setProgram(children[i], program);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxFZmZlY3QwNy5qcyJdLCJuYW1lcyI6WyJfZGVmYXVsdF92ZXJ0IiwicmVxdWlyZSIsIl9kZWZhdWx0X3ZlcnRfbm9fbXZwIiwiX2dsYXNzX2ZyYWciLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImdsYXNzRmFjdG9yIiwiZmxhZ1NoYWRlciIsIm11bHRpbGluZSIsInRvb2x0aXAiLCJvbkxvYWQiLCJwYXJhbWV0ZXJzIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInRpbWUiLCJtb3VzZSIsIngiLCJ5IiwicmVzb2x1dGlvbiIsIm5vZGUiLCJvbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJNT1VTRV9NT1ZFIiwiZXZlbnQiLCJnZXRDb250ZW50U2l6ZSIsIndpZHRoIiwiZ2V0TG9jYXRpb25YIiwiaGVpZ2h0IiwiZ2V0TG9jYXRpb25ZIiwiVE9VQ0hfTU9WRSIsIl91c2UiLCJ1cGRhdGUiLCJkdCIsIl9wcm9ncmFtIiwidXNlIiwidXBkYXRlR0xQYXJhbWV0ZXJzIiwic3lzIiwiaXNOYXRpdmUiLCJnbFByb2dyYW1fc3RhdGUiLCJHTFByb2dyYW1TdGF0ZSIsImdldE9yQ3JlYXRlV2l0aEdMUHJvZ3JhbSIsInNldFVuaWZvcm1WZWMyIiwic2V0VW5pZm9ybUZsb2F0Iiwic2V0VW5pZm9ybUxvY2F0aW9uV2l0aDJmIiwiX3Jlc29sdXRpb24iLCJzZXRVbmlmb3JtTG9jYXRpb25XaXRoMWYiLCJfdGltZSIsIl9tb3VzZSIsImxvZyIsIkdMUHJvZ3JhbSIsImluaXRXaXRoU3RyaW5nIiwiYWRkQXR0cmlidXRlIiwibWFjcm8iLCJBVFRSSUJVVEVfTkFNRV9QT1NJVElPTiIsIlZFUlRFWF9BVFRSSUJfUE9TSVRJT04iLCJBVFRSSUJVVEVfTkFNRV9DT0xPUiIsIlZFUlRFWF9BVFRSSUJfQ09MT1IiLCJBVFRSSUJVVEVfTkFNRV9URVhfQ09PUkQiLCJWRVJURVhfQVRUUklCX1RFWF9DT09SRFMiLCJsaW5rIiwidXBkYXRlVW5pZm9ybXMiLCJpbml0V2l0aFZlcnRleFNoYWRlckJ5dGVBcnJheSIsImdldFVuaWZvcm1Mb2NhdGlvbkZvck5hbWUiLCJzZXRQcm9ncmFtIiwiX3NnTm9kZSIsInByb2dyYW0iLCJzZXRHTFByb2dyYW1TdGF0ZSIsInNldFNoYWRlclByb2dyYW0iLCJjaGlsZHJlbiIsImkiLCJsZW5ndGgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsYUFBYSxHQUFHQyxPQUFPLENBQUMscUNBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsb0JBQW9CLEdBQUdELE9BQU8sQ0FBQywyQ0FBRCxDQUFsQzs7QUFDQSxJQUFJRSxXQUFXLEdBQUdGLE9BQU8sQ0FBQyxzQ0FBRCxDQUF6Qjs7QUFFQUcsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFdBQVcsRUFBQyxHQURKO0FBRVJDLElBQUFBLFVBQVUsRUFBRTtBQUNSLGlCQUFTLDJ6QkFERDtBQUVSQyxNQUFBQSxTQUFTLEVBQUUsSUFGSDtBQUdSQyxNQUFBQSxPQUFPLEVBQUU7QUFIRDtBQUZKLEdBSFA7QUFhTEMsRUFBQUEsTUFBTSxFQUFFLGtCQUFZO0FBQ2hCLFNBQUtDLFVBQUwsR0FBZ0I7QUFDWkMsTUFBQUEsU0FBUyxFQUFDQyxJQUFJLENBQUNDLEdBQUwsRUFERTtBQUVaQyxNQUFBQSxJQUFJLEVBQUMsR0FGTztBQUdaQyxNQUFBQSxLQUFLLEVBQUM7QUFDRkMsUUFBQUEsQ0FBQyxFQUFDLEdBREE7QUFFRkMsUUFBQUEsQ0FBQyxFQUFDO0FBRkEsT0FITTtBQU9aQyxNQUFBQSxVQUFVLEVBQUM7QUFDUEYsUUFBQUEsQ0FBQyxFQUFDLEdBREs7QUFFUEMsUUFBQUEsQ0FBQyxFQUFDO0FBRks7QUFQQyxLQUFoQjtBQWFBLFNBQUtFLElBQUwsQ0FBVUMsRUFBVixDQUFhbkIsRUFBRSxDQUFDb0IsSUFBSCxDQUFRQyxTQUFSLENB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S0FBSy9CLFFBQXpDO0FBQ0gsR0FqSUk7QUFtSUw4QixFQUFBQSxVQUFVLEVBQUMsb0JBQVU3QyxJQUFWLEVBQWdCK0MsT0FBaEIsRUFBeUI7QUFDaEMsUUFBSWpFLEVBQUUsQ0FBQ29DLEdBQUgsQ0FBT0MsUUFBWCxFQUFxQjtBQUNqQixVQUFJQyxlQUFlLEdBQUd0QyxFQUFFLENBQUN1QyxjQUFILENBQWtCQyx3QkFBbEIsQ0FBMkN5QixPQUEzQyxDQUF0QjtBQUNBL0MsTUFBQUEsSUFBSSxDQUFDZ0QsaUJBQUwsQ0FBdUI1QixlQUF2QjtBQUNILEtBSEQsTUFHSztBQUNEcEIsTUFBQUEsSUFBSSxDQUFDaUQsZ0JBQUwsQ0FBc0JGLE9BQXRCO0FBQ0g7O0FBR0QsUUFBSUcsUUFBUSxHQUFHbEQsSUFBSSxDQUFDa0QsUUFBcEI7QUFDQSxRQUFJLENBQUNBLFFBQUwsRUFDSTs7QUFFSixTQUFLLElBQUlDLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdELFFBQVEsQ0FBQ0UsTUFBN0IsRUFBcUNELENBQUMsRUFBdEM7QUFDSSxXQUFLTixVQUFMLENBQWdCSyxRQUFRLENBQUNDLENBQUQsQ0FBeEIsRUFBNkJKLE9BQTdCO0FBREo7QUFFSDtBQWxKSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2RlZmF1bHRfdmVydCA9IHJlcXVpcmUoXCIuLi9TaGFkZXJzL2NjU2hhZGVyX0RlZmF1bHRfVmVydC5qc1wiKTtcclxudmFyIF9kZWZhdWx0X3ZlcnRfbm9fbXZwID0gcmVxdWlyZShcIi4uL1NoYWRlcnMvY2NTaGFkZXJfRGVmYXVsdF9WZXJ0X25vTVZQLmpzXCIpO1xyXG52YXIgX2dsYXNzX2ZyYWcgPSByZXF1aXJlKFwiLi4vU2hhZGVycy9jY1NoYWRlcl9FZmZlY3QwNF9GcmFnLmpzXCIpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBnbGFzc0ZhY3RvcjoxLjAsXHJcbiAgICAgICAgZmxhZ1NoYWRlcjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiAnXCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsgdW5pZm9ybSBmbG9hdCB0aW1lOyB1bmlmb3JtIHZlYzIgbW91c2U7IHVuaWZvcm0gdmVjMiByZXNvbHV0aW9uOyBjb25zdCBpbnQgbnVtQmxvYnMgPSAxMjg7IHZvaWQgbWFpbiggdm9pZCApIHsgICAgIHZlYzIgcCA9IChnbF9GcmFnQ29vcmQueHkgLyByZXNvbHV0aW9uLngpIC0gdmVjMigwLjUsIDAuNSAqIChyZXNvbHV0aW9uLnkgLyByZXNvbHV0aW9uLngpKTsgICAgIHZlYzMgYyA9IHZlYzMoMC4wKTsgICAgIGZvciAoaW50IGk9MDsgaTxudW1CbG9iczsgaSsrKSAgeyAgICAgICBmbG9hdCBweCA9IHNpbihmbG9hdChpKSowLjEgKyAwLjUpICogMC40OyAgICAgICBmbG9hdCBweSA9IHNpbihmbG9hdChpKmkpKjAuMDEgKyAwLjQqdGltZSkgKiAwLjI7ICAgICAgIGZsb2F0IHB6ID0gc2luKGZsb2F0KGkqaSppKSowLjAwMSArIDAuMyp0aW1lKSAqIDAuMyArIDAuNDsgICAgICBmbG9hdCByYWRpdXMgPSAwLjAwNSAvIHB6OyAgICAgIHZlYzIgcG9zID0gcCArIHZlYzIocHgsIHB5KTsgICAgICAgIGZsb2F0IHogPSByYWRpdXMgLSBsZW5ndGgocG9zKTsgICAgICAgICBpZiAoeiA8IDAuMCkgeiA9IDAuMDsgICAgICAgZmxvYXQgY2MgPSB6IC8gcmFkaXVzOyAgICAgIGMgKz0gdmVjMyhjYyAqIChzaW4oZmxvYXQoaSppKmkpKSAqIDAuNSArIDAuNSksIGNjICogKHNpbihmbG9hdChpKmkqaSppKmkpKSAqIDAuNSArIDAuNSksIGNjICogKHNpbihmbG9hdChpKmkqaSppKSkgKiAwLjUgKyAwLjUpKTsgIH0gICBnbF9GcmFnQ29sb3IgPSB2ZWM0KGMueCtwLnksIGMueStwLnksIGMueitwLnksIDEuMCk7IH1cIiwnLFxyXG4gICAgICAgICAgICBtdWx0aWxpbmU6IHRydWUsXHJcbiAgICAgICAgICAgIHRvb2x0aXA6ICdGbGFnU2hhZGVyJyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSwgXHJcblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzPXtcclxuICAgICAgICAgICAgc3RhcnRUaW1lOkRhdGUubm93KCksXHJcbiAgICAgICAgICAgIHRpbWU6MC4wLFxyXG4gICAgICAgICAgICBtb3VzZTp7XHJcbiAgICAgICAgICAgICAgICB4OjAuMCxcclxuICAgICAgICAgICAgICAgIHk6MC4wLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICByZXNvbHV0aW9uOntcclxuICAgICAgICAgICAgICAgIHg6MC4wLFxyXG4gICAgICAgICAgICAgICAgeTowLjAsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuTU9VU0VfTU9WRSwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1ldGVycy5tb3VzZS54ID0gdGhpcy5ub2RlLmdldENvbnRlbnRTaXplKCkud2lkdGggLyBldmVudC5nZXRMb2NhdGlvblgoKTtcclxuICAgICAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLm1vdXNlLnkgPSB0aGlzLm5vZGUuZ2V0Q29udGVudFNpemUoKS5oZWlnaHQgLyBldmVudC5nZXRMb2NhdGlvblkoKTsgXHJcbiAgICAgICAgfSwgdGhpcyk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLm5vZGUub24oIGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmFtZXRlcnMubW91c2UueCA9IHRoaXMubm9kZS5nZXRDb250ZW50U2l6ZSgpLndpZHRoIC8gZXZlbnQuZ2V0TG9jYXRpb25YKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1ldGVycy5tb3VzZS55ID0gdGhpcy5ub2RlLmdldENvbnRlbnRTaXplKCkuaGVpZ2h0IC8gZXZlbnQuZ2V0TG9jYXRpb25ZKCk7IFxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLl91c2UoKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGU6ZnVuY3Rpb24oZHQpe1xyXG4gICAgICAgIGlmKHRoaXMuZ2xhc3NGYWN0b3I+PTQwKXtcclxuICAgICAgICAgICAgdGhpcy5nbGFzc0ZhY3Rvcj0wO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmdsYXNzRmFjdG9yKz1kdCozO1xyXG5cclxuICAgICAgICBpZih0aGlzLl9wcm9ncmFtKXtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0udXNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlR0xQYXJhbWV0ZXJzKCk7XHJcbiAgICAgICAgICAgIGlmKGNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICB2YXIgZ2xQcm9ncmFtX3N0YXRlID0gY2MuR0xQcm9ncmFtU3RhdGUuZ2V0T3JDcmVhdGVXaXRoR0xQcm9ncmFtKHRoaXMuX3Byb2dyYW0pO1xyXG4gICAgICAgICAgICAgICAgZ2xQcm9ncmFtX3N0YXRlLnNldFVuaWZvcm1WZWMyKCBcInJlc29sdXRpb25cIiwgdGhpcy5wYXJhbWV0ZXJzLnJlc29sdXRpb24gKTtcclxuICAgICAgICAgICAgICAgIGdsUHJvZ3JhbV9zdGF0ZS5zZXRVbmlmb3JtRmxvYXQoIFwidGltZVwiLCB0aGlzLnBhcmFtZXRlcnMudGltZSApOyAgICBcclxuICAgICAgICAgICAgICAgIGdsUHJvZ3JhbV9zdGF0ZS5zZXRVbmlmb3JtVmVjMiggXCJtb3VzZV90b3VjaFwiICwgdGhpcy5wYXJhbWV0ZXJzLm1vdXNlICk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5zZXRVbmlmb3JtTG9jYXRpb25XaXRoMmYoIHRoaXMuX3Jlc29sdXRpb24sIHRoaXMucGFyYW1ldGVycy5yZXNvbHV0aW9uLngsdGhpcy5wYXJhbWV0ZXJzLnJlc29sdXRpb24ueSApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5zZXRVbmlmb3JtTG9jYXRpb25XaXRoMWYoIHRoaXMuX3RpbWUsIHRoaXMucGFyYW1ldGVycy50aW1lICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmFtLnNldFVuaWZvcm1Mb2NhdGlvbldpdGgyZiggdGhpcy5fbW91c2UsIHRoaXMucGFyYW1ldGVycy5tb3VzZS54LHRoaXMucGFyYW1ldGVycy5tb3VzZS54ICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlR0xQYXJhbWV0ZXJzKCl7XHJcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLnRpbWUgPSAoRGF0ZS5ub3coKSAtIHRoaXMucGFyYW1ldGVycy5zdGFydFRpbWUpLzEwMDA7XHJcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLnJlc29sdXRpb24ueCA9ICggdGhpcy5ub2RlLmdldENvbnRlbnRTaXplKCkud2lkdGggKTtcclxuICAgICAgICB0aGlzLnBhcmFtZXRlcnMucmVzb2x1dGlvbi55ID0gKCB0aGlzLm5vZGUuZ2V0Q29udGVudFNpemUoKS5oZWlnaHQgKTtcclxuXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfdXNlOiBmdW5jdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICBjYy5sb2coXCJ1c2UgbmF0aXZlIEdMUHJvZ3JhbVwiKTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbSA9IG5ldyBjYy5HTFByb2dyYW0oKTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5pbml0V2l0aFN0cmluZyhfZGVmYXVsdF92ZXJ0X25vX212cCwgdGhpcy5mbGFnU2hhZGVyICk7XHJcblxyXG5cclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5hZGRBdHRyaWJ1dGUoY2MubWFjcm8uQVRUUklCVVRFX05BTUVfUE9TSVRJT04sIGNjLm1hY3JvLlZFUlRFWF9BVFRSSUJfUE9TSVRJT04pO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLmFkZEF0dHJpYnV0ZShjYy5tYWNyby5BVFRSSUJVVEVfTkFNRV9DT0xPUiwgY2MubWFjcm8uVkVSVEVYX0FUVFJJQl9DT0xPUik7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0uYWRkQXR0cmlidXRlKGNjLm1hY3JvLkFUVFJJQlVURV9OQU1FX1RFWF9DT09SRCwgY2MubWFjcm8uVkVSVEVYX0FUVFJJQl9URVhfQ09PUkRTKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0ubGluaygpO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLnVwZGF0ZVVuaWZvcm1zKCk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlR0xQYXJhbWV0ZXJzKCk7XHJcblxyXG5cclxuICAgICAgICAgICBcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbSA9IG5ldyBjYy5HTFByb2dyYW0oKTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5pbml0V2l0aFZlcnRleFNoYWRlckJ5dGVBcnJheShfZGVmYXVsdF92ZXJ0LCB0aGlzLmZsYWdTaGFkZXIgKTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5hZGRBdHRyaWJ1dGUoY2MubWFjcm8uQVRUUklCVVRFX05BTUVfUE9TSVRJT04sIGNjLm1hY3JvLlZFUlRFWF9BVFRSSUJfUE9TSVRJT04pO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLmFkZEF0dHJpYnV0ZShjYy5tYWNyby5BVFRSSUJVVEVfTkFNRV9DT0xPUiwgY2MubWFjcm8uVkVSVEVYX0FUVFJJQl9DT0xPUik7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0uYWRkQXR0cmlidXRlKGNjLm1hY3JvLkFUVFJJQlVURV9OQU1FX1RFWF9DT09SRCwgY2MubWFjcm8uVkVSVEVYX0FUVFJJQl9URVhfQ09PUkRTKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0ubGluaygpO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLnVwZGF0ZVVuaWZvcm1zKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0udXNlKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUdMUGFyYW1ldGVycygpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5zZXRVbmlmb3JtTG9jYXRpb25XaXRoMWYoIHRoaXMuX3Byb2dyYW0uZ2V0VW5pZm9ybUxvY2F0aW9uRm9yTmFtZSgndGltZScpLCB0aGlzLnBhcmFtZXRlcnMudGltZSApO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLnNldFVuaWZvcm1Mb2NhdGlvbldpdGgyZiggdGhpcy5fcHJvZ3JhbS5nZXRVbmlmb3JtTG9jYXRpb25Gb3JOYW1lKCdtb3VzZV90b3VjaCcpLCB0aGlzLnBhcmFtZXRlcnMubW91c2UueCx0aGlzLnBhcmFtZXRlcnMubW91c2UueSApO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9ncmFtLnNldFVuaWZvcm1Mb2NhdGlvbldpdGgyZih0aGlzLl9wcm9ncmFtLmdldFVuaWZvcm1Mb2NhdGlvbkZvck5hbWUoJ3Jlc29sdXRpb24nKSwgdGhpcy5wYXJhbWV0ZXJzLnJlc29sdXRpb24ueCx0aGlzLnBhcmFtZXRlcnMucmVzb2x1dGlvbi55ICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgdmFyIGdsUHJvZ3JhbV9zdGF0ZSA9IGNjLkdMUHJvZ3JhbVN0YXRlLmdldE9yQ3JlYXRlV2l0aEdMUHJvZ3JhbSh0aGlzLl9wcm9ncmFtKTtcclxuICAgICAgICAgICAgZ2xQcm9ncmFtX3N0YXRlLnNldFVuaWZvcm1WZWMyKCBcInJlc29sdXRpb25cIiwgdGhpcy5wYXJhbWV0ZXJzLnJlc29sdXRpb24gKTtcclxuICAgICAgICAgICAgZ2xQcm9ncmFtX3N0YXRlLnNldFVuaWZvcm1GbG9hdCggXCJ0aW1lXCIgLCB0aGlzLnBhcmFtZXRlcnMudGltZSApO1xyXG4gICAgICAgICAgICBnbFByb2dyYW1fc3RhdGUuc2V0VW5pZm9ybVZlYzIoIFwibW91c2VfdG91Y2hcIiAsIHRoaXMucGFyYW1ldGVycy5tb3VzZSApO1xyXG4gICAgICAgIH1lbHNle1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdXRpb24gPSB0aGlzLl9wcm9ncmFtLmdldFVuaWZvcm1Mb2NhdGlvbkZvck5hbWUoIFwicmVzb2x1dGlvblwiICk7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSB0aGlzLl9wcm9ncmFtLmdldFVuaWZvcm1Mb2NhdGlvbkZvck5hbWUoIFwidGltZVwiICk7XHJcbiAgICAgICAgICAgIHRoaXMuX21vdXNlID0gdGhpcy5fcHJvZ3JhbS5nZXRVbmlmb3JtTG9jYXRpb25Gb3JOYW1lKCBcIm1vdXNlX3RvdWNoXCIgKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0uc2V0VW5pZm9ybUxvY2F0aW9uV2l0aDJmKCB0aGlzLl9yZXNvbHV0aW9uLCB0aGlzLnBhcmFtZXRlcnMucmVzb2x1dGlvbi54LHRoaXMucGFyYW1ldGVycy5yZXNvbHV0aW9uLnkgKTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZ3JhbS5zZXRVbmlmb3JtTG9jYXRpb25XaXRoMWYoIHRoaXMuX3RpbWUsIHRoaXMucGFyYW1ldGVycy50aW1lICk7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyYW0uc2V0VW5pZm9ybUxvY2F0aW9uV2l0aDJmKCB0aGlzLl9tb3VzZSwgdGhpcy5wYXJhbWV0ZXJzLm1vdXNlLngsdGhpcy5wYXJhbWV0ZXJzLm1vdXNlLnkgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2V0UHJvZ3JhbSggdGhpcy5ub2RlLl9zZ05vZGUgLHRoaXMuX3Byb2dyYW0gKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHNldFByb2dyYW06ZnVuY3Rpb24gKG5vZGUsIHByb2dyYW0pIHtcclxuICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHZhciBnbFByb2dyYW1fc3RhdGUgPSBjYy5HTFByb2dyYW1TdGF0ZS5nZXRPckNyZWF0ZVdpdGhHTFByb2dyYW0ocHJvZ3JhbSk7XHJcbiAgICAgICAgICAgIG5vZGUuc2V0R0xQcm9ncmFtU3RhdGUoZ2xQcm9ncmFtX3N0YXRlKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgbm9kZS5zZXRTaGFkZXJQcm9ncmFtKHByb2dyYW0pOyAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICBcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIGlmICghY2hpbGRyZW4pXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgIFxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvZ3JhbShjaGlsZHJlbltpXSwgcHJvZ3JhbSk7XHJcbiAgICB9XHJcblxyXG59KTtcclxuIl19