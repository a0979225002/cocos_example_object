{"version":3,"sources":["assets\\Script\\Glass2.js"],"names":["_default_vert","require","_default_vert_no_mvp","_glass_frag","cc","Class","Component","properties","glassFactor","frag_glsl","visible","onLoad","self","now","Date","parameters","startTime","time","mouse","x","y","z","w","resolution","date","getYear","getMonth","getDate","getTime","getMilliseconds","isMouseDown","loader","loadRes","err","txt","log","_use","update","dt","_program","use","updateGLParameters","sys","isNative","glProgram_state","GLProgramState","getOrCreateWithGLProgram","setUniformFloat","setUniformVec3","setUniformVec4","setUniformLocationWith1f","_uniBlurRadiusScale","setUniformLocationWith3f","_resolution","_time","setUniformLocationWith4f","_mouse","_date","node","getContentSize","width","height","GLProgram","initWithString","addAttribute","macro","ATTRIBUTE_NAME_POSITION","VERTEX_ATTRIB_POSITION","ATTRIBUTE_NAME_COLOR","VERTEX_ATTRIB_COLOR","ATTRIBUTE_NAME_TEX_COORD","VERTEX_ATTRIB_TEX_COORDS","link","updateUniforms","initWithVertexShaderByteArray","getUniformLocationForName","_uniWidthStep","_uniHeightStep","setProgram","_sgNode","program","setGLProgramState","setShaderProgram","children","i","length"],"mappings":"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","sourceRoot":"/","sourcesContent":["var _default_vert = require(\"../Shaders/ccShader_Default_Vert.js\");\r\nvar _default_vert_no_mvp = require(\"../Shaders/ccShader_Default_Vert_noMVP.js\");\r\nvar _glass_frag = require(\"../Shaders/ccShader_Glass_Frag.js\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        glassFactor:1.0,\r\n        frag_glsl:{\r\n            default:\"Effect10.fs.glsl\",\r\n            visible:false,\r\n        },\r\n    },\r\n\r\n    onLoad: function () {\r\n        var self = this;\r\n        var now = new Date();\r\n        this.parameters={\r\n            startTime:Date.now(),\r\n            time:0.0,\r\n            mouse:{\r\n                x:0.0,\r\n                y:0.0,\r\n                z:0.0,\r\n                w:0.0,\r\n            },\r\n            resolution:{\r\n                x:0.0,\r\n                y:0.0,\r\n                z:1.0,\r\n            },\r\n            date:{\r\n                x:now.getYear(),//year\r\n                y:now.getMonth(),//month\r\n                z:now.getDate(),//day\r\n                w:now.getTime()+now.getMilliseconds()/1000,//time seconds\r\n            },\r\n            isMouseDown:false,\r\n\r\n        };\r\n\r\n        cc.loader.loadRes(self.frag_glsl,function(err,txt){\r\n            if(err){\r\n                cc.log(err)\r\n            }else{\r\n                self.frag_glsl = txt;\r\n                self._use();\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    update:function(dt){\r\n        if(this.glassFactor>=40){\r\n            this.glassFactor=0;\r\n        }\r\n        this.glassFactor+=dt*3;\r\n\r\n        if(this._program){\r\n\r\n            this._program.use();\r\n            this.updateGLParameters();\r\n            if(cc.sys.isNative){\r\n                var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);\r\n                glProgram_state.setUniformFloat( \"blurRadiusScale\" ,this.glassFactor);\r\n                glProgram_state.setUniformVec3( \"iResolution\", this.parameters.resolution );\r\n                glProgram_state.setUniformFloat( \"iGlobalTime\", this.parameters.time );    \r\n                glProgram_state.setUniformVec4( \"iMouse\" , this.parameters.mouse );\r\n                glProgram_state.setUniformVec4( \"iDate\" , this.parameters.date );\r\n            }else{\r\n                this._program.setUniformLocationWith1f( this._uniBlurRadiusScale, this.glassFactor );\r\n                this._program.setUniformLocationWith3f( this._resolution, this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n                this._program.setUniformLocationWith1f( this._time, this.parameters.time );\r\n                this._program.setUniformLocationWith4f( this._mouse, this.parameters.mouse.x,this.parameters.mouse.y,this.parameters.mouse.z,this.parameters.mouse.w );\r\n                this._program.setUniformLocationWith4f( this._date, this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n            }\r\n        }\r\n    },\r\n    updateGLParameters(){\r\n        this.parameters.time = (Date.now() - this.parameters.startTime)/1000;\r\n        this.parameters.resolution.x = ( this.node.getContentSize().width );\r\n        this.parameters.resolution.y = ( this.node.getContentSize().height );\r\n        var now = new Date();\r\n\r\n        this.parameters.date={\r\n                x:now.getYear(),//year\r\n                y:now.getMonth(),//month\r\n                z:now.getDate(),//day\r\n                w:now.getTime()+now.getMilliseconds()/1000,//time seconds\r\n            };\r\n    },\r\n\r\n\r\n    _use: function()\r\n    {\r\n        \r\n        this._program = new cc.GLProgram();\r\n        if (cc.sys.isNative) {\r\n            cc.log(\"use native GLProgram\");\r\n            this._program = new cc.GLProgram();\r\n            this._program.initWithString(_default_vert_no_mvp, this.frag_glsl );\r\n\r\n\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);\r\n\r\n            this._program.link();\r\n            this._program.updateUniforms();\r\n            this.updateGLParameters();\r\n            \r\n        }else{\r\n             this._program = new cc.GLProgram();\r\n            this._program.initWithVertexShaderByteArray(_default_vert, this.frag_glsl );\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION, cc.macro.VERTEX_ATTRIB_POSITION);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR, cc.macro.VERTEX_ATTRIB_COLOR);\r\n            this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD, cc.macro.VERTEX_ATTRIB_TEX_COORDS);\r\n\r\n            this._program.link();\r\n            this._program.updateUniforms();\r\n            this._program.use();\r\n\r\n            this.updateGLParameters();\r\n\r\n            this._program.setUniformLocationWith3f(this._program.getUniformLocationForName('iResolution'), this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n            this._program.setUniformLocationWith1f( this._program.getUniformLocationForName('iGlobalTime'), this.parameters.time );\r\n            this._program.setUniformLocationWith4f( this._program.getUniformLocationForName('iMouse'), this.parameters.mouse.x,this.parameters.mouse.y , this.parameters.mouse.z,this.parameters.mouse.w);\r\n            this._program.setUniformLocationWith4f( this._program.getUniformLocationForName('iDate'), this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n        }\r\n        \r\n        \r\n        \r\n        \r\n        if (cc.sys.isNative) {\r\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(this._program);\r\n            glProgram_state.setUniformFloat( \"widthStep\" , ( 1.0 / this.node.getContentSize().width ) );\r\n            glProgram_state.setUniformFloat( \"heightStep\" , ( 1.0 / this.node.getContentSize().height ) );\r\n            glProgram_state.setUniformFloat( \"blurRadiusScale\" ,this.glassFactor);\r\n            glProgram_state.setUniformVec3( \"iResolution\", this.parameters.resolution );\r\n            glProgram_state.setUniformFloat( \"iGlobalTime\" , this.parameters.time );\r\n            glProgram_state.setUniformVec4( \"iMouse\" , this.parameters.mouse );\r\n        }else{\r\n\r\n\r\n            this._uniWidthStep = this._program.getUniformLocationForName( \"widthStep\" );\r\n            this._uniHeightStep = this._program.getUniformLocationForName( \"heightStep\" );\r\n            this._uniBlurRadiusScale = this._program.getUniformLocationForName( \"blurRadiusScale\" );\r\n\r\n            this._program.setUniformLocationWith1f( this._uniWidthStep, ( 1.0 / this.node.getContentSize().width ) );\r\n            this._program.setUniformLocationWith1f( this._uniHeightStep, ( 1.0 / this.node.getContentSize().height ) );\r\n            this._program.setUniformLocationWith1f( this._uniBlurRadiusScale, this.glassFactor );\r\n\r\n            this._resolution = this._program.getUniformLocationForName( \"iResolution\" );\r\n            this._time = this._program.getUniformLocationForName( \"iGlobalTime\" );\r\n            this._mouse = this._program.getUniformLocationForName( \"iMouse\" );\r\n\r\n            this._program.setUniformLocationWith3f( this._resolution, this.parameters.resolution.x,this.parameters.resolution.y,this.parameters.resolution.z );\r\n            this._program.setUniformLocationWith1f( this._time, this.parameters.time );\r\n            this._program.setUniformLocationWith4f( this._mouse, this.parameters.mouse.x,this.parameters.mouse.y ,this.parameters.mouse.z,this.parameters.mouse.w);\r\n            this._program.setUniformLocationWith4f( this._date, this.parameters.date.x,this.parameters.date.y,this.parameters.date.z,this.parameters.date.w );\r\n        }\r\n\r\n        this.setProgram( this.node._sgNode ,this._program );\r\n    },\r\n    \r\n    setProgram:function (node, program) {\r\n        if (cc.sys.isNative) {\r\n            var glProgram_state = cc.GLProgramState.getOrCreateWithGLProgram(program);\r\n            node.setGLProgramState(glProgram_state);\r\n        }else{\r\n            node.setShaderProgram(program);    \r\n        }\r\n        \r\n    \r\n        var children = node.children;\r\n        if (!children)\r\n            return;\r\n    \r\n        for (var i = 0; i < children.length; i++)\r\n            this.setProgram(children[i], program);\r\n    }\r\n\r\n});\r\n"]}