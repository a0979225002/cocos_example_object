{"version":3,"sources":["assets\\script\\controllers\\ui\\UIMusic.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIBase from \"./UIBase\";\r\nimport DataUIMusic from \"../../data/scene/DataUIMusic\";\r\nimport LangMng from \"../../manager/LangMng\";\r\nimport MusicMng from \"../../manager/MusicMng\";\r\n\r\nenum BtnType {\r\n    Music,\r\n    Effect,\r\n}\r\n\r\nconst {ccclass} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UIMusic extends UIBase {\r\n\r\n    ui: DataUIMusic = null;\r\n\r\n    protected static prefabUrl = \"music_panel\";\r\n    protected static className = \"UIMusic\";\r\n\r\n    private _isLangSet: boolean = false;\r\n    private _closeX: number = -33;\r\n    private _openX: number = 33;\r\n    private _closeColor: cc.Color = new cc.Color(190, 190, 190, 255);\r\n    private _openColor: cc.Color = new cc.Color(0, 133, 255, 255);\r\n\r\n    onInit(): void {\r\n        cc.game.addPersistRootNode(this.node);\r\n        this.resize();\r\n    }\r\n\r\n    onUILoad(): void {\r\n\r\n        this.ui = this.node.addComponent(DataUIMusic);\r\n\r\n        this.updateBtnDisplay(BtnType.Music);\r\n        this.updateBtnDisplay(BtnType.Effect);\r\n\r\n        this.hide(false);\r\n\r\n    }\r\n\r\n    onShow(): void {\r\n\r\n        this.setLang();\r\n\r\n        this.onRegisterEvent(this.ui.btn_close, this.onBtnCloseClick, this);\r\n        this.onRegisterEvent(this.ui.btn_music, this.onBtnMusicClick, this);\r\n        this.onRegisterEvent(this.ui.btn_effect, this.onBtnEffectClick, this);\r\n\r\n    }\r\n\r\n    onHide(): void {\r\n\r\n\r\n        this.unRegisterEvent(this.ui.btn_music, this.onBtnCloseClick, this);\r\n        this.unRegisterEvent(this.ui.btn_close, this.onBtnMusicClick, this);\r\n        this.unRegisterEvent(this.ui.btn_effect, this.onBtnEffectClick, this);\r\n\r\n    }\r\n\r\n    onBtnCloseClick(): void {\r\n        this.hide();\r\n    }\r\n\r\n    onBtnMusicClick(): void {\r\n        MusicMng.switchMusic();\r\n        this.updateBtnDisplay(BtnType.Music);\r\n    }\r\n\r\n    onBtnEffectClick(): void {\r\n        MusicMng.switchEffect();\r\n        this.updateBtnDisplay(BtnType.Effect);\r\n    }\r\n\r\n    updateBtnDisplay(type: BtnType): void {\r\n\r\n        let state = type == 0 ? MusicMng.getMusicState() : MusicMng.getEffectState();\r\n        let circleNode = type == 0 ? this.ui.node_musicCircle : this.ui.node_effectCircle;\r\n        let bgNode = type == 0 ? this.ui.node_musicBg : this.ui.node_effectBg;\r\n        let targetPosX = state ? this._openX : this._closeX;\r\n        let targetColor = state ? this._openColor : this._closeColor;\r\n\r\n        circleNode.stopAllActions();\r\n        circleNode.runAction(\r\n            cc.moveTo(.2, targetPosX, 0).easing(cc.easeSineOut()),\r\n        );\r\n\r\n        bgNode.stopAllActions();\r\n        bgNode.runAction(\r\n            cc.tintTo(.2, targetColor.getR(), targetColor.getG(), targetColor.getB())\r\n        );\r\n    }\r\n\r\n    show(): void {\r\n\r\n        if (this.node.active) {\r\n            return;\r\n        }\r\n\r\n        this.node.active = true;\r\n        this.fadeIn();\r\n\r\n    }\r\n\r\n    hide(isAni: boolean = true) {\r\n\r\n        if (!this.node.active) {\r\n            return;\r\n        }\r\n\r\n        if (isAni) {\r\n            this.fadeOut();\r\n            return;\r\n        }\r\n\r\n        this.node.active = false;\r\n\r\n    }\r\n\r\n    fadeIn(): void {\r\n        this.ui.node_main.setPosition(0, 2000);\r\n        this.ui.node_main.stopAllActions();\r\n        this.ui.node_main.runAction(cc.sequence(\r\n            cc.moveTo(.3, 0, 0).easing(cc.easeQuarticActionInOut()),\r\n            cc.callFunc(() => {\r\n\r\n            })\r\n        ));\r\n    }\r\n\r\n    fadeOut(): void {\r\n        this.ui.node_main.stopAllActions();\r\n        this.ui.node_main.runAction(cc.sequence(cc.moveTo(.2, 0, 2000).easing(cc.easeSineOut()),\r\n            cc.callFunc(() => {\r\n                this.node.active = false;\r\n            })\r\n        ));\r\n    }\r\n\r\n    setLang(): void {\r\n\r\n        if (this._isLangSet) {\r\n            return;\r\n        }\r\n\r\n        this.ui.label_music.string = LangMng.getTxt(\"MB_008\");\r\n        this.ui.label_effect.string = LangMng.getTxt(\"MB_009\");\r\n        this.ui.label_close.string = LangMng.getTxt(\"P_1003\");\r\n\r\n        this._isLangSet = true;\r\n\r\n    }\r\n\r\n    resize(): void {\r\n        const pos = this.getCanvas();\r\n        this.node.setPosition(pos.x, pos.y);\r\n    }\r\n\r\n}"]}