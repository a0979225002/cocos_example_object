{"version":3,"sources":["assets\\script\\controllers\\mine\\collect\\CollectGeneral.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameCenter from \"../../../data/GameCenter\";\r\nimport GameController from \"../../../GameController\";\r\nimport AssetsMng from \"../../../manager/AssetsMng\";\r\nimport UIBase from \"../../ui/UIBase\";\r\nimport ParticleCoin from \"./ParticleCoin\";\r\nimport DataCollectGeneral from \"../../../data/scene/DataCollectGeneral\";\r\nimport { ActionTransition } from \"../../../common/ActionTransition\";\r\nimport { MainEvent } from \"../../../data/const/EventConst\";\r\n\r\nconst { ccclass } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CollectGeneral extends UIBase {\r\n\r\n    ui: DataCollectGeneral;\r\n    particleCoin: ParticleCoin;\r\n\r\n    canUpdateMine: boolean = true;\r\n\r\n    onUILoad(): void {\r\n        this.ui = this.node.addComponent(DataCollectGeneral);\r\n        this.particleCoin = this.ui.node_coin_particle_holder.addComponent(ParticleCoin);\r\n        this.viewReset();\r\n    }\r\n\r\n    onShow(): void {\r\n        this.initEvent(MainEvent.GET_POINT, this.onGetPoint);\r\n        this.initEvent(MainEvent.MINE_GENERAL_UPDATE, this.onMineUpdate);\r\n        this.onRegisterEvent(this.ui.btn_get, this.onBtnGetClick, this);\r\n        this.dataReset();\r\n        cc.game.on(cc.game.EVENT_SHOW, () => {\r\n            this.updateMine();\r\n        });\r\n        this.updateChooseIcon();\r\n    }\r\n\r\n    onHide(): void {\r\n        this.unRegisterEvent(this.ui.btn_get, this.onBtnGetClick, this);\r\n    }\r\n\r\n    viewReset(): void {\r\n        this.setRoadTheme();\r\n        this.setPetSpineTheme();\r\n        this.setPartnerSpineTheme();\r\n        this.roadActive(false);\r\n        this.petActive(false);\r\n        this.partnerActive(false);\r\n        this.coinActive(false);\r\n        this.mineTipHide();\r\n        this.ui.label_time.string = \"00:00:00\";\r\n        this.ui.btn_get.active = false;\r\n        this.ui.btn_get.opacity = 0;\r\n        this.ui.node_coin_level_holder.opacity = 0;\r\n    }\r\n\r\n    dataReset(): void {\r\n        this.setGoldPoint();\r\n        this.setSliverPoint();\r\n        this.updateWarehousePoint();\r\n        this.updateMoneyPile();\r\n        this.updateBtnGetState();\r\n    }\r\n\r\n    mineAniPlay(): void {\r\n        this.roadAniPlay(() => {\r\n            this.petRunAniPlay();\r\n            this.partnerRunAniPlay();\r\n            this.coinRunAniPlay();\r\n            this.mineTipShow();\r\n        });\r\n    }\r\n\r\n    roadActive(state: boolean = true): void {\r\n        this.ui.spine_road.node.stopAllActions();\r\n        this.ui.spine_road.node.active = state;\r\n    }\r\n\r\n    roadAniPlay(callBack?: Function): void {\r\n        this.roadActive();\r\n        this.ui.spine_road.node.runAction(cc.sequence(\r\n            cc.callFunc(() => {\r\n                this.ui.spine_road.setAnimation(0, \"run_op\", false);\r\n                this.ui.spine_road.addAnimation(0, \"run_action\", true);\r\n            }),\r\n            cc.delayTime(1),\r\n            cc.callFunc(() => {\r\n                this.ui.btn_get.active = true;\r\n                this.ui.btn_get.runAction(cc.fadeIn(.2));\r\n                this.ui.node_coin_level_holder.runAction(cc.fadeIn(.2));\r\n                if (callBack) callBack();\r\n            }),\r\n        ));\r\n    }\r\n\r\n    setRoadTheme(): void {\r\n        let id = GameCenter.game.mineSelectID;\r\n        let name = GameCenter.game.mineRoadName[id];\r\n        this.ui.spine_road.skeletonData = AssetsMng.getAssets(`${name}.spine`);\r\n    }\r\n\r\n    petActive(state: boolean = true): void {\r\n        this.ui.spine_pet.node.active = state;\r\n    }\r\n\r\n    petRunAniPlay(): void {\r\n        this.petActive();\r\n        this.ui.spine_pet.setAnimation(0, `run_patch_02`, true);\r\n    }\r\n\r\n    setPetSpineTheme(): void {\r\n        let name = GameCenter.game.getPetBodyThemeName();\r\n\r\n        this.petActive();\r\n        this.ui.spine_pet.skeletonData = AssetsMng.getAssets(`${name}.spine`);\r\n        this.setPetSkin();\r\n    }\r\n\r\n    setPetSkin(): void {\r\n        this.ui.spine_pet.setSkin(GameCenter.game.getPetBodySkinName());\r\n    }\r\n\r\n    partnerActive(state: boolean = true): void {\r\n        this.ui.spine_partner.node.active = state;\r\n    }\r\n\r\n    partnerRunAniPlay(): void {\r\n        this.partnerActive();\r\n        this.ui.spine_partner.setAnimation(0, `run_patch_02`, true);\r\n    }\r\n\r\n    setPartnerSpineTheme(): void {\r\n        let name = GameCenter.game.getPartnerBodyThemeName();\r\n        this.partnerActive();\r\n        this.ui.spine_partner.skeletonData = AssetsMng.getAssets(`${name}.spine`);\r\n    }\r\n\r\n    coinActive(state: boolean = true): void {\r\n        this.ui.spine_coin.node.active = state;\r\n    }\r\n\r\n    coinRunAniPlay(): void {\r\n        this.coinActive();\r\n        this.ui.spine_coin.setAnimation(0, `run_patch_02`, true);\r\n    }\r\n\r\n    mineTipShow(): void {\r\n        this.ui.node_mine_tip_holder.active = true;\r\n        this.ui.node_mine_tip_holder.runAction(cc.fadeIn(.3));\r\n    }\r\n\r\n    mineTipHide(): void {\r\n        this.ui.node_mine_tip_holder.opacity = 0;\r\n        this.ui.node_mine_tip_holder.active = false;\r\n    }\r\n\r\n    timeNumberChange(num: number): string {\r\n        return num < 10 ? `0${num}` : `${num}`;\r\n    }\r\n\r\n    formatSecond(secs): string {\r\n        let hr = Math.floor(secs / 3600);\r\n        let min = Math.floor((secs - (hr * 3600)) / 60);\r\n        let sec = secs - (hr * 3600) - (min * 60);\r\n        return ` ${this.timeNumberChange(hr)}:${this.timeNumberChange(min)}:${this.timeNumberChange(sec)}`;\r\n    }\r\n\r\n    getAccumulatedHours(): number {\r\n        return Math.floor(GameCenter.game.currentTime / 3600);\r\n    }\r\n\r\n    setGoldPoint(): void {\r\n        this.ui.label_gold.string = `${GameCenter.game.goldPoint}`;\r\n    }\r\n\r\n    setSliverPoint(): void {\r\n        this.ui.label_sliver.string = `${GameCenter.game.silverPoint}`;\r\n    }\r\n\r\n    updatePoints(): void {\r\n        this.setGoldPoint();\r\n        this.setSliverPoint();\r\n    }\r\n\r\n    updateWarehousePoint(): void {\r\n        this.ui.label_coin_txt.string = `${GameCenter.game.warehousePoint}`;\r\n    }\r\n\r\n    updateMoneyPile(): void {\r\n\r\n        let level = this.getMoneyPileLevel();\r\n        let nodeArr = this.ui.node_coin_level_holder.children;\r\n\r\n        for (let i = 0; i < nodeArr.length; i++) {\r\n           nodeArr[i].active = i == level;\r\n        }\r\n\r\n    }\r\n\r\n    getMoneyPileLevel(): number {\r\n\r\n        let hr = this.getAccumulatedHours();\r\n        let level = 0;\r\n\r\n        if (hr < 6) {\r\n            level = 0;\r\n        } else if (hr >= 6 && hr < 12) {\r\n            level = 1;\r\n        } else if (hr >= 12) {\r\n            level = 2;\r\n        }\r\n\r\n        return level;\r\n\r\n    }\r\n\r\n    onBtnGetClick(): void {\r\n        ActionTransition.btnBounce(this.ui.btn_get);\r\n        GameController.net.send(\"action\", null);\r\n    }\r\n\r\n    onGetPoint(): void {\r\n\r\n        let goldNum = Number(GameCenter.game.collect.gold);\r\n        let sliverNum = Number(GameCenter.game.collect.silver);\r\n\r\n        goldNum = goldNum <= 30 ? goldNum : 30;\r\n        sliverNum = sliverNum <= 30 ? sliverNum : 30;\r\n\r\n        this.particleCoin.createCoins(cc.v2(0, -510), goldNum, sliverNum, () => {\r\n            this.updatePoints();\r\n        });\r\n\r\n    }\r\n\r\n    onMineUpdate(): void {\r\n        this.updateWarehousePoint();\r\n        this.updateBtnGetState();\r\n        this.updateMoneyPile();\r\n    }\r\n\r\n    updateMine(): void {\r\n\r\n        if (this.canUpdateMine) {\r\n            this.canUpdateMine = false;\r\n            GameController.net.send(\"other\", null);\r\n            const timer = setTimeout(() => {\r\n                this.canUpdateMine = true;\r\n                clearTimeout(timer)\r\n            }, 30)\r\n        }\r\n\r\n    }\r\n\r\n    updateTime(): void {\r\n\r\n        if (!GameCenter.game.timeActive) {\r\n            if (this.ui.label_time.string != this.formatSecond(0)) {\r\n                this.ui.label_time.string = this.formatSecond(0);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (this.ui.label_time.string != this.formatSecond(GameCenter.game.currentTime)) {\r\n\r\n            this.ui.label_time.string = this.formatSecond(GameCenter.game.currentTime);\r\n\r\n            if (GameCenter.game.currentTime % 3600 == 0 && GameCenter.game.currentTime > 0) {\r\n                this.updateMine();\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    updateBtnGetState(): void {\r\n\r\n        let hr = this.getAccumulatedHours();\r\n\r\n        if (hr < 6) {\r\n            this.ui.node_get_normal.active = true;\r\n            this.ui.node_get_active.active = false;\r\n        } else {\r\n            this.ui.node_get_normal.active = false;\r\n            this.ui.node_get_active.active = true;\r\n        }\r\n\r\n    }\r\n\r\n    updateChooseIcon(): void {\r\n        this.ui.sprite_icon_mine.spriteFrame = GameCenter.getCurrentPetChooseIcon();\r\n        this.ui.sprite_icon_partner.spriteFrame = GameCenter.getCurrentPartnerChooseIcon();\r\n    }\r\n\r\n    protected update(dt: number) {\r\n        if (!this.node.active) { return; }\r\n        this.updateTime();\r\n    }\r\n\r\n}"]}