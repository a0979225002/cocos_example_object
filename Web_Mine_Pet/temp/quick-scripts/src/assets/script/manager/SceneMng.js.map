{"version":3,"sources":["assets\\script\\manager\\SceneMng.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIMessage from \"../controllers/ui/UIMessage\";\r\nimport UIHelp from \"../controllers/ui/UIHelp\";\r\nimport UILoading from \"../controllers/ui/UILoading\";\r\n\r\nexport type CompletedCallback = (completedCount: number, totalCount: number, item: any) => void;\r\n\r\nenum SceneName {\r\n    Login,\r\n    Game\r\n}\r\n\r\nclass SceneMng {\r\n\r\n    private _nowScene: SceneName = SceneName.Login;\r\n    private _resizeActive: boolean = false;\r\n    private _resizeDt: number = 0;\r\n\r\n    constructor() {\r\n        this.init();\r\n    }\r\n\r\n\r\n    init(): void {\r\n\r\n        this.resizeBindOn();\r\n\r\n    }\r\n\r\n    preload(sceneName: string, onCompleted?: CompletedCallback): void {\r\n        cc.director.preloadScene(sceneName, onCompleted);\r\n    }\r\n\r\n\r\n    load(sceneName: string): void {\r\n        cc.director.loadScene(sceneName, () => {\r\n            this.resize();\r\n        });\r\n    }\r\n\r\n    goGame(): void {\r\n        this.load(\"mainGame\");\r\n        this._nowScene = SceneName.Game;\r\n    }\r\n\r\n    getCurrentSceneName(): SceneName {\r\n        return this._nowScene;\r\n    }\r\n\r\n    resize(): void {\r\n        this.setCanvasSize();\r\n        UIHelp.Resize(UILoading);\r\n        UIHelp.Resize(UIMessage);\r\n    }\r\n    setCanvasSize(): void {\r\n\r\n        if (!cc) { return; }\r\n\r\n        let canvasSize = this.getWinSize();\r\n\r\n        if (canvasSize.height / canvasSize.width <= 16 / 9) {\r\n\r\n            cc.view.setDesignResolutionSize(750, 1333, new cc.ResolutionPolicy(cc.ContainerStrategy.PROPORTION_TO_FRAME, cc.ContentStrategy.NO_BORDER));\r\n        } else {\r\n            if (canvasSize.height / canvasSize.width > 16 / 9 && canvasSize.height / canvasSize.width <= 19.5 / 9) {\r\n\r\n                cc.view.setDesignResolutionSize(750, 1624, new cc.ResolutionPolicy(cc.ContainerStrategy.EQUAL_TO_FRAME, cc.ContentStrategy.FIXED_WIDTH))\r\n            } else {\r\n\r\n                cc.view.setDesignResolutionSize(750, 1624, new cc.ResolutionPolicy(cc.ContainerStrategy.PROPORTION_TO_FRAME, cc.ContentStrategy.NO_BORDER))\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    resizeBindOn(): void {\r\n        window.addEventListener(\"resize\", this.debounce(() => {\r\n            this.resize();\r\n            this._resizeActive = true;\r\n        }));\r\n    }\r\n\r\n\r\n    resizeUpdate(): void {\r\n\r\n        if (this._resizeActive) {\r\n\r\n            this._resizeDt++;\r\n\r\n            if (this._resizeDt <= 3 || this._resizeDt >= 96) {\r\n                this.resize();\r\n            }\r\n\r\n            if (this._resizeDt > 100) {\r\n                this._resizeActive = false;\r\n                this._resizeDt = 0;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    debounce(func: Function) {\r\n        let timer;\r\n        return function (event) {\r\n            if (timer) clearTimeout(timer);\r\n            timer = setTimeout(func, 300, event);\r\n        };\r\n    }\r\n\r\n    getWinSize() {\r\n        return {width: window.innerWidth, height: window.innerHeight};\r\n    }\r\n\r\n    get nowScene(): SceneName {\r\n        return this._nowScene;\r\n    }\r\n\r\n    set nowScene(value: SceneName) {\r\n        this._nowScene = value;\r\n    }\r\n\r\n}\r\n\r\nexport default new SceneMng();"]}