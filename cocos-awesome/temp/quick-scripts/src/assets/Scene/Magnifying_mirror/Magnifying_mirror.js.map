{"version":3,"sources":["assets\\Scene\\Magnifying_mirror\\Magnifying_mirror.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA8C,oCAAY;IAA1D;QAAA,qEA8CC;QA5CG,YAAM,GAAY,IAAI,CAAC;QAEvB,sBAAgB,GAAY,IAAI,CAAC;QAEjC,0BAAoB,GAAY,IAAI,CAAC;QAGrC,cAAQ,GAAY,IAAI,CAAC;QAUzB,mBAAa,GAAY,IAAI,CAAC;QAC9B,qBAAe,GAAY,IAAI,CAAC;;IA0BpC,CAAC;IApCG,iCAAM,GAAN;QACE,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;QACzC,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;QAE7D,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;QACxE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;IACxE,CAAC;IAID,0CAAe,GAAf,UAAgB,KAAK;QACnB,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;QACzC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;IACnD,CAAC;IAED,yCAAc,GAAd,UAAe,KAAK;QAClB,IAAI,QAAQ,GAAY,KAAK,CAAC,WAAW,EAAE,CAAC;QAC5C,IAAI,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAA;QAEzE,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAC7B,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;IACzC,CAAC;IAED,qCAAU,GAAV;QACE,IAAI,WAAW,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;QAE3C,IAAI,OAAO,GAAG,IAAI,EAAE,CAAC,aAAa,EAAE,CAAC;QACrC,OAAO,CAAC,YAAY,CAAC,WAAW,CAAC,KAAK,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;QAC5D,IAAI,WAAW,GAAG,IAAI,EAAE,CAAC,WAAW,EAAE,CAAC;QACvC,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAChC,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,aAAa,GAAG,OAAO,CAAC;QAEtE,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,WAAW,CAAC;QAC5E,IAAI,CAAC,oBAAoB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACxC,CAAC;IA3CD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACK;IAEvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;8DACe;IAEjC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kEACmB;IANpB,gBAAgB;QADpC,OAAO;OACa,gBAAgB,CA8CpC;IAAD,uBAAC;CA9CD,AA8CC,CA9C6C,EAAE,CAAC,SAAS,GA8CzD;kBA9CoB,gBAAgB","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MagnifyingMirror extends cc.Component {\r\n    @property(cc.Node)\r\n    mirror: cc.Node = null;\r\n    @property(cc.Node)\r\n    mirrorCameraNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    tempCameraSpriteNode: cc.Node = null;\r\n\r\n\r\n    viewSize: cc.Size = null;\r\n    onLoad () {\r\n      this.viewSize = cc.view.getVisibleSize();\r\n      this.initCamera();\r\n      this.mirrorCameraNode.setPosition(this.mirror.getPosition());\r\n\r\n      this.node.on(cc.Node.EventType.TOUCH_START, this.touchStartEvent, this);\r\n      this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touchMoveEvent, this);\r\n    }\r\n\r\n    touchStartPos: cc.Vec2 = null;\r\n    mirrorOriginPos: cc.Vec2 = null;\r\n    touchStartEvent(event) {\r\n      this.touchStartPos = event.getLocation();\r\n      this.mirrorOriginPos = this.mirror.getPosition();\r\n    }\r\n\r\n    touchMoveEvent(event) {\r\n      let touchPos: cc.Vec2 = event.getLocation();\r\n      let pos = this.mirrorOriginPos.add(touchPos.subtract(this.touchStartPos))\r\n\r\n      this.mirror.setPosition(pos);\r\n      this.mirrorCameraNode.setPosition(pos);\r\n    }\r\n\r\n    initCamera() {\r\n      let visibleRect = cc.view.getVisibleSize();\r\n\r\n      let texture = new cc.RenderTexture();\r\n      texture.initWithSize(visibleRect.width, visibleRect.height);\r\n      let spriteFrame = new cc.SpriteFrame();\r\n      spriteFrame.setTexture(texture);\r\n      this.mirrorCameraNode.getComponent(cc.Camera).targetTexture = texture;\r\n\r\n      this.tempCameraSpriteNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n      this.tempCameraSpriteNode.scaleY = -1;\r\n    }\r\n}\r\n"]}