{"version":3,"sources":["assets\\Scene\\Bullet_Tracking\\Bullet_Tracking.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Bullet_Tracking extends cc.Component {\r\n  @property(cc.Node)\r\n  launch_btn: cc.Node = null;\r\n\r\n  @property(cc.Node)\r\n  bullet: cc.Node = null;\r\n\r\n  @property(cc.Node)\r\n  target: cc.Node = null;\r\n\r\n  onLoad() {\r\n    this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touchMoveEvent, this);\r\n  }\r\n\r\n  touchMoveEvent(evt: cc.Event.EventTouch) {\r\n    this.target.x += evt.getDeltaX();\r\n    this.target.y += evt.getDeltaY();\r\n  }\r\n\r\n  fireFlag: boolean = false;\r\n  fire() {\r\n    this.bullet.getComponent(cc.Sprite).enabled = true;\r\n    this.bullet.getChildByName('boom').active = false;\r\n    this.bullet.setPosition(this.launch_btn.position);\r\n    this.bullet.active = true;\r\n    this.fireFlag = true;\r\n  }\r\n\r\n  hitTheTarget() {\r\n    this.fireFlag = false;\r\n    this.bullet.getComponent(cc.Sprite).enabled = false;\r\n    this.bullet.getChildByName('boom').active = true;\r\n    this.scheduleOnce(() => {\r\n      this.bullet.getChildByName('boom').active = false;\r\n    }, 0.2);\r\n  }\r\n\r\n  bulletSpeed = 200;\r\n  update(dt) {\r\n    if (!this.fireFlag) return;\r\n\r\n    let targetPos: cc.Vec2 = this.target.getPosition();\r\n    let bulletPos: cc.Vec2 = this.bullet.getPosition();\r\n    let normalizeVec: cc.Vec2 = targetPos.subtract(bulletPos).normalize();\r\n\r\n    this.bullet.x += normalizeVec.x * this.bulletSpeed * dt;\r\n    this.bullet.y += normalizeVec.y * this.bulletSpeed * dt;\r\n    // 角度变化以y轴正方向为起点，逆时针角度递增\r\n    this.bullet.angle = cc.v2(0, 1).signAngle(normalizeVec) * 180 / Math.PI;\r\n\r\n    let rect = this.target.getBoundingBox();\r\n    if (rect.contains(bulletPos)) this.hitTheTarget();\r\n  }\r\n}\r\n"]}